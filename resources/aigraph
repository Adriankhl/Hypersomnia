digraph g {
ordering=out;

"Evade"[shape=diamond]
"Get close"[shape=diamond]
"Evade bullets"[shape=diamond]

Legs->"Go get a better weapon"
Legs->"Seeing enemy"
Legs->"Saw enemy"
Legs->"Walk around"

"Seeing enemy"->"Has a gun"
"Has a gun"->"Evade bullets"
"Seeing enemy"->"Has melee"
"Has melee"->"Get close"
"Seeing enemy"->"Evade"

"Go to last seen enemy pos"[shape=diamond]
Escape2[label="Escape", shape=diamond]
"Saw enemy"->"Has a weapon"
"Has a weapon"->"Go to last seen enemy pos"
"Saw enemy"->Escape2

seeingenemy[label="Seeing enemy"]


"Reload weapons"[shape=diamond]
Hands->seeingenemy
Hands->"Reload weapons"

Reload[shape=diamond]
"Pick best melee and swing"[shape=diamond]
"Shoot"[shape=diamond]
seeingenemy->"Has compatible gun and mags"
"Has compatible gun and mags"->"Has ammo in current mag"
"Has ammo in current mag"->"Shoot"
"Has compatible gun and mags"->Reload
seeingenemy->"Enemy in melee range"
"Enemy in melee range"->"Pick best melee and swing"
}